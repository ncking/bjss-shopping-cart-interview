!function(t){function e(o){if(n[o])return n[o].exports;var r=n[o]={exports:{},id:o,loaded:!1};return t[o].call(r.exports,r,r.exports,e),r.loaded=!0,r.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){"use strict";$(function(){function t(t){return $(t).closest("[data-stock-id]").attr("data-stock-id")}function e(){$(".basket-items").html(p({basket:c})),o()}function o(){i.convert(c.getTotal()).then(function(t){$(".basket-total").html(_({totalCost:r["float"](t),symbol:i.getCurrencySymbol(),name:i.getCurrencyName()}))})}var r=n(2),i=n(5),a=n(8),s=n(3),c=new s(a),u=n(10),p=n(9),_=n(12),d=n(11),l=u({currencies:i.getCurrencies(),stockItems:a.findAll(),stockItemTemplate:d});$("main").html(l),$("body").on("change",".js-currency",function(){i.setCurrency($(this).val()),o()}),$("body").on("click",".stock-add",function(){c.addItemById(t(this)),e()}),$("body").on("click",".stock-remove",function(){c.removeItemById(t(this)),e()})})},function(t,e,n){var o=n(13);if(!o.length)throw new Error("Currencies empty");t.exports={getData:function(){return o},currencyCodes:function(){return o.map(function(t){return t.id})},getCurrency:function(t){return o.filter(function(e){return e.id===t}).pop()}}},function(t,e){t.exports={"float":function(t,e){return parseFloat(t).toFixed(2)}}},function(t,e,n){var o=n(4);t.exports=function(t){function e(t){var e=r.indexOf(t);e>-1&&r.splice(e,1)}function n(t){return r.filter(function(e){if(e.getId()==t)return e}).pop()}var r=[];return{addItemById:function(e){var i=n(e);if(i)i.adjustQuantity(1);else{var a=t.findById(e);i=new o(a),r.push(i)}},removeItemById:function(t){var o=n(t);o&&(o.adjustQuantity(-1),o.getQuantity()||e(o))},getItems:function(){return r},empty:function(){r=[]},getTotal:function(){return r.reduce(function(t,e){return t+=Number(e.getTotal())},0)}}}},function(t,e,n){function o(t){this.stockItem=t,this.quantity=1}var r=n(2);o.prototype={getId:function(){return this.stockItem.getId()},getTotal:function(){return r["float"](this.getQuantity()*this.stockItem.getPrice())},getQuantity:function(){return this.quantity},adjustQuantity:function(t){this.quantity+=parseInt(t)}},t.exports=o},function(t,e,n){var o,r=n(1),i=n(6),a={setCurrency:function(t){o=r.getCurrency(t)},getCurrencySymbol:function(){return o.symbol},getCurrencyName:function(){return o.name},getCurrencies:function(){return r.getData()},convert:function(t){return i.convert(o.id,t)}};a.setCurrency("GBP"),t.exports=a},function(t,e,n){function o(t){return"USD"+t.toUpperCase()}function r(){return s?$.Deferred().resolve(!0):$.ajax({cache:!1,data:{access_key:a,currencies:i.currencyCodes().join(","),format:1},method:"GET",url:"http://www.apilayer.net/api/live",dataType:"json"}).then(function(t){t.success&&t.quotes&&(c=1/parseFloat(t.quotes[o("GBP")]),t.quotes&&(s=t.quotes))})}var i=n(1),a="1012f4f88519dd41e75aba9574894b07",s=null,c=0;t.exports={convert:function(t,e){return r().then(function(){var n=c*parseFloat(e),r=s[o(t)]*n;return r})}}},function(t,e){function n(t){this._data=t}n.prototype={get:function(t){return this._data[t]},getTitle:function(){return this.get("title")},getPrice:function(){return this.get("unit_price")},getUnitDescription:function(){return this.get("unit_desc")},getId:function(){return this.get("id")}},t.exports=n},function(t,e,n){var o=n(7),r=n(14);t.exports={stockItems:null,findById:function(t){for(var e=this.findAll(),n=e.length-1;n>=0;n--)if(e[n].getId()==t)return e[n]},findAll:function(){var t,e=[];if(!this.stockItems){for(var n in r)t=new o(r[n]),e.push(t);this.stockItems=e}return this.stockItems}}},function(module,exports){module.exports=function anonymous(locals,escape,include,rethrow){function encode_char(t){return _ENCODE_HTML_RULES[t]||t}escape=escape||function(t){return void 0==t?"":String(t).replace(_MATCH_HTML,encode_char)};var _ENCODE_HTML_RULES={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&#34;","'":"&#39;"},_MATCH_HTML=/[&<>'"]/g,__output=[],__append=__output.push.bind(__output);with(locals||{})for(var items=basket.getItems(),len=items.length,i=0;i<len;i++){var item=items[i],stockItem=item.stockItem;__append('\r\n    <li class="basket-item">\r\n        '),__append(stockItem.getTitle()),__append(" (x "),__append(item.getQuantity()),__append(" @ £"),__append(stockItem.getPrice()),__append(')  <i class="basket-item-total">£'),__append(item.getTotal()),__append("</i>\r\n    </li>\r\n")}return __output.join("")}},function(module,exports){module.exports=function anonymous(locals,escape,include,rethrow){function encode_char(t){return _ENCODE_HTML_RULES[t]||t}escape=escape||function(t){return void 0==t?"":String(t).replace(_MATCH_HTML,encode_char)};var _ENCODE_HTML_RULES={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&#34;","'":"&#39;"},_MATCH_HTML=/[&<>'"]/g,__output=[],__append=__output.push.bind(__output);with(locals||{}){__append('<ul class="store">\n    ');for(var i=0;i<stockItems.length;i++){var stockItem=stockItems[i];__append("\n            <li data-stock-id="),__append(stockItem.getId()),__append(">\n                "),__append(stockItem.getTitle()),__append(" -- \n                <span>£ "),__append(stockItem.getPrice()),__append(" </span>\n                <span>"),__append(stockItem.getUnitDescription()),__append('</span>\n                <span class="step stock-remove">-</span>\n                <span class="step stock-add">+</span>\n            </li>\n    ')}__append('\n</ul>\n\n<div class="basket">\n    <div class="basket-wrap">\n        <ul class="basket-items">\n\n        </ul>\n    </div>\n    <ul class="basket-footer">\n        <li>\n            <select class="basket-currency js-currency">\n                ');for(var i=0;i<currencies.length;i++)__append('\n                    <option value="'),__append(currencies[i].id),__append('">'),__append(currencies[i].name),__append("</option>\n                ");__append('\n            </select>\n        </li>\n        <li>TOTAL: <span class="basket-total"></span></li>\n    </ul>\n</div>')}return __output.join("")}},function(module,exports){module.exports=function anonymous(locals,escape,include,rethrow){function encode_char(t){return _ENCODE_HTML_RULES[t]||t}escape=escape||function(t){return void 0==t?"":String(t).replace(_MATCH_HTML,encode_char)};var _ENCODE_HTML_RULES={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&#34;","'":"&#39;"},_MATCH_HTML=/[&<>'"]/g,__output=[],__append=__output.push.bind(__output);with(locals||{})__append("<li data-stock-id="),__append(stockItem.getId()),__append(">\n    "),__append(stockItem.getTitle()),__append(" -- \n    <span>£ "),__append(stockItem.getPrice()),__append(" </span>\n    <span>"),__append(stockItem.getUnitDescription()),__append('</span>\n    <span class="step stock-remove">-</span>\n    <span class="step stock-add">+</span>\n</li>\n                \n                ');return __output.join("")}},function(module,exports){module.exports=function anonymous(locals,escape,include,rethrow){function encode_char(t){return _ENCODE_HTML_RULES[t]||t}escape=escape||function(t){return void 0==t?"":String(t).replace(_MATCH_HTML,encode_char)};var _ENCODE_HTML_RULES={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&#34;","'":"&#39;"},_MATCH_HTML=/[&<>'"]/g,__output=[],__append=__output.push.bind(__output);with(locals||{})__append(symbol),__append(totalCost),__append("  "),__append(name),__append("\r\n\r\n");return __output.join("")}},function(t,e){t.exports=[{id:"GBP",name:"UK pound",symbol:"£"},{id:"USD",name:"US Dollar",symbol:"$"},{id:"AED",name:"United Arab Emirates Dirham",symbol:"درهم"}]},function(t,e){t.exports=[{title:"Peas",unit_price:.95,unit_desc:"per bag",id:1},{title:"Eggs",unit_price:2.1,unit_desc:"per dozen",id:2},{title:"Milk",unit_price:1.3,unit_desc:"per bottle",id:3},{title:"Beans",unit_price:.73,unit_desc:"per can",id:4}]}]);